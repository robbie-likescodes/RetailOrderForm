<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Retail Order Portal</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="globalBanner" class="banner" hidden></div>
  <section id="homeScreen" class="home">
    <div class="home__card">
      <h1 class="home__title">RETAIL ORDERS</h1>
      <div class="home__menu">
        <button class="btn btn--primary" id="homeOrder" type="button">Order</button>
        <button class="btn btn--ghost btn--drivers" id="homeDrivers" type="button">Delivery Drivers</button>
        <button class="btn btn--ghost" id="homeHistory" type="button">History</button>
        <button class="btn btn--ghost" id="homeReports" type="button">Reports</button>
      </div>
    </div>
  </section>

  <div id="orderApp" hidden>
    <header class="topbar">
      <div class="topbar__row">
        <div>
          <div class="title">Retail Orders</div>
          <div class="subtitle" id="lastUpdated">Catalog: not loaded</div>
          <div class="subtitle" id="apiHealth">API: checking…</div>
        </div>
        <div class="topbar__actions">
          <button class="btn btn--ghost btn--icon btn--home" id="topbarHomeBtn" type="button" aria-label="Back to home" title="Home">
            <svg class="btn__icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 10.5L12 3l9 7.5"></path>
              <path d="M5 10v10a1 1 0 0 0 1 1h4v-6h4v6h4a1 1 0 0 0 1-1V10"></path>
            </svg>
          </button>
          <button class="btn btn--ghost" id="refreshBtn" data-refresh="catalog" type="button" aria-label="Refresh products from Google Sheets" title="Refresh products from Google Sheets">Refresh Products</button>
        </div>
      </div>

      <div class="meta" id="orderMeta">
        <label class="field">
          <span>Store</span>
          <input id="store" placeholder="Boniface / Huffman / ..." autocomplete="off" required />
        </label>

        <div class="meta__row">
          <label class="field">
            <span>Requested date</span>
            <input id="requestedDate" type="date" required />
          </label>
        </div>

        <label class="field">
          <span>Placed by</span>
          <input id="placedBy" placeholder="Name" autocomplete="name" required />
        </label>

        <label class="field">
          <span>Email</span>
          <input id="email" placeholder="optional" inputmode="email" autocomplete="email" />
        </label>

        <label class="field">
          <span>Notes</span>
          <textarea id="notes" rows="3" placeholder="Optional notes for this order"></textarea>
        </label>
      </div>
    </header>

  <main class="container">
    <section id="orderPanel" class="stack">
      <section id="catalog" class="card catalog">
        <div class="catalog__header">
          <div>
            <h2 class="catalog__title">Select a category</h2>
            <p class="catalog__hint">Choose a category to browse products and add quantities.</p>
          </div>
          <div class="catalog__summary" id="selectedSummary">Selected: 0</div>
        </div>
        <div id="categoryList" class="categoryGrid"></div>
      </section>

      <section id="items" class="card items" hidden>
        <div class="items__header">
          <button class="btn btn--ghost" id="backToCategories" type="button">Back to categories</button>
          <div class="items__headerText">
            <h2 id="categoryTitle">Items</h2>
            <div class="items__meta" id="categoryMeta"></div>
          </div>
          <div class="items__summary" id="itemsSummary">Selected: 0</div>
        </div>
        <div id="itemList" class="itemList"></div>
        <div class="items__footer">
          <button class="btn btn--ghost" id="backToCategoriesBottom" type="button">Back to categories</button>
        </div>
      </section>

      <button class="btn btn--full" id="reviewBtn" type="button">Review & Submit</button>
      <div class="error" id="errorBox" hidden></div>
      <div class="success" id="statusBox" hidden></div>

      <section id="review" class="card" hidden>
        <h2>Review</h2>
        <div id="reviewList" class="reviewList"></div>
        <div class="actions">
          <button class="btn" id="editBtn" type="button">Back to editing</button>
          <button class="btn btn--primary" id="submitBtn" type="button">Submit Order</button>
        </div>
        <div class="error" id="submitError" hidden></div>
        <div class="success" id="submitSuccess" hidden></div>
      </section>
    </section>

    <section id="reports" class="card tabPanel" hidden>
      <div class="reports__header">
        <div>
          <h2>Reports</h2>
          <p class="muted">Compare product usage across stores and timeframes.</p>
          <p class="muted reports__status" id="reportStatus">History: not loaded</p>
        </div>
        <div class="reports__summary">
          <div class="reports__metric">
            <span>Orders in history</span>
            <strong id="reportHistoryCount">0</strong>
          </div>
          <div class="reports__metric">
            <span>Top store (range)</span>
            <strong id="reportTopStore">—</strong>
          </div>
        </div>
      </div>

      <div class="reports__section">
        <h3>Side-by-side store comparison</h3>
        <p class="muted reports__hint">Compare stores across quick timeframes (last month, last quarter, last year) plus a custom range.</p>
        <div class="reports__filters reports__filters--compact">
          <label class="field field--stores">
            <span>Stores</span>
            <div id="compareStores" class="multiselect" data-placeholder="Select stores">
              <button type="button" class="multiselect__toggle" aria-haspopup="listbox" aria-expanded="false">
                Select stores
              </button>
              <div class="multiselect__menu" role="listbox" aria-multiselectable="true"></div>
            </div>
            <small class="field__help">Select one or more stores.</small>
          </label>
          <label class="field field--scope">
            <span>Compare by</span>
            <select id="compareScope">
              <option value="product">Product</option>
              <option value="category">Category</option>
            </select>
          </label>
          <label class="field field--product" id="compareProductField">
            <span>Product</span>
            <select id="compareProduct">
              <option value="">Select a product</option>
            </select>
          </label>
          <label class="field field--category" id="compareCategoryField" hidden>
            <span>Category</span>
            <select id="compareCategory">
              <option value="">Select a category</option>
            </select>
          </label>
          <label class="field field--start">
            <span>Start date &amp; time</span>
            <input id="compareStart" type="datetime-local" />
          </label>
          <label class="field field--end">
            <span>End date &amp; time</span>
            <input id="compareEnd" type="datetime-local" />
          </label>
          <label class="field field--sort">
            <span>Sort</span>
            <select id="compareSort">
              <option value="qty-desc">Qty (high to low)</option>
              <option value="qty-asc">Qty (low to high)</option>
              <option value="store-asc">Store (A → Z)</option>
              <option value="store-desc">Store (Z → A)</option>
            </select>
          </label>
        </div>
        <div class="reports__subnote" id="compareRangeHint"></div>
        <div class="tableWrap tableWrap--wide">
          <table class="table table--compare">
            <thead id="compareHead"></thead>
            <tbody id="compareBody"></tbody>
          </table>
          <div class="empty" id="compareEmpty" hidden>Select a product or category to compare stores.</div>
        </div>
      </div>
    </section>
  </main>

  <div id="toastContainer" class="toastContainer"></div>

  <script src="shared.js"></script>
  <script src="app.js"></script>
</body>
</html>
